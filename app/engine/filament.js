window.Filament||(window.Filament={gameDir:"./game/"}),Filament.loadScript=(e=>new Promise(t=>{e instanceof Array||(e=[e]);const a=document.createElement("script");a.src=e.shift(),e.length?a.onload=(()=>Filament.loadScript(e).then(t)):a.onload=t,document.head.append(a)})),Filament.loadStyle=(e=>{const t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),document.head.append(t)}),Filament.path=((...e)=>{let t="";for(;e.length;)e[0]?t+=`${t&&"/"!==t[t.length-1]?"/":""}${e.shift()}`:e.shift();return t}),Filament.gameFile=(e=>Filament.path(Filament.gameDir,e)),Filament.loadGame=(()=>{const e=["engine/engine.js"];Filament.electron&&(Filament.vue.$data.editor=!0,e.push("engine/editor.js")),e.push(Filament.gameFile("game.js")),Filament.loadScript(e)}),Filament.loadStyle(Filament.gameFile("style.css"));try{const{remote:e,ipcRenderer:t}=require("electron");Filament.electron={remote:e,ipc:t,mainProcess:e.require("./main.js"),window:e.getCurrentWindow(),dialog:e.dialog}}catch(e){}Filament.editor={enabled:Boolean(Filament.electron)},Filament.lzma=new LZMA("./lib/lzma_worker-min.js"),Filament.lzma.compress_promise=((e,t=1,a)=>new Promise((n,i)=>{Filament.lzma.compress(e,t,(e,t)=>{t?i(t):n(e)},a)})),Filament.lzma.decompress_promise=((e,t)=>new Promise((a,n)=>{Filament.lzma.decompress(e,(e,t)=>{t?n(t):a(e)},t)})),Filament.saveGameData=async function(){await Filament.lzma.compress_promise(Filament.savedata,1)},Filament.loadGameData=async function(){await Filament.lzma.decompress_promise("TODO")},Filament.saveFile=async function(e,t,a=!0){t=Filament.gameFile(t),a&&(e=JSON.stringify(e));await Filament.lzma.compress_promise(e,1)},Filament.loadFile=async function(e,t=!0){e=Filament.gameFile(e)},Filament.saveData=async function(e,t,a=!0){a&&(e=JSON.stringify(e));let n=await Filament.lzma.compress_promise(e,1);n=n.map(e=>String.fromCodePoint((e<0?e+256:e)+32)).join(""),window.localStorage.set(`${Filament.settings.slug}-${t}`,n)},Filament.loadData=async function(e,t=!0){e=`${Filament.settings.slug}-${e}`;let a=window.localStorage.get(e);return a=new Int8Array(Array.prototype.map.call(a,e=>e.codePointAt(0)-32)),a=await Filament.lzma.decompress_promise(a),t&&(a=JSON.parse(a)),a},Filament.vue=new Vue({el:"#wrapper",data:{activeScreen:null,screens:[],editor:!1,panels:{}}}),Filament.editorScreen=((e,t)=>{const a=Filament.vue.$data,n={id:a.screens.length,name:e,component:t};0===a.screens.length&&(a.activeScreen=n),a.screens.push(n)}),Filament.editorScreen("Map",{template:'<div id="screen-game" tabindex="0">\n\t\t<canvas id="pixi-canvas"></canvas>\n\t\t<div id="ui-container"></div>\n\t</div>',mounted(){Filament.loadGame()}});
//# sourceMappingURL=filament.js.map
