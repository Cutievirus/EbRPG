{"version":3,"sources":["0_filament.js","lzma.js","vue.js"],"names":["window","Filament","gameDir","loadScript","sources","Promise","resolve","Array","script","document","createElement","src","shift","length","onload","then","head","append","loadStyle","source","stylesheet","setAttribute","path","parts","gameFile","filename","loadGame","scripts","electron","vue","$data","editor","push","remote","ipcRenderer","ipc","require","mainProcess","getCurrentWindow","dialog","err","lzma","LZMA","compress_promise","data","mode","progress","reject","compress","result","error","decompress_promise","decompress","save","async","savedata","load","Vue","el","activeScreen","screens","editorScreen","name","component","v","screen","id","template","[object Object]"],"mappings":"AAAAA,OAAAC,WAAAD,OAAAC,SAAA,CACAC,QAAA,YAGAD,SAAAE,WAAAC,CAAAA,GACA,IAAAC,QAAAC,IACAF,aAAAG,QAAAH,EAAA,CAAAA,IACA,MAAAI,EAAAC,SAAAC,cAAA,UACAF,EAAAG,IAAAP,EAAAQ,QACAR,EAAAS,OACAL,EAAAM,OAAA,KAAAb,SAAAE,WAAAC,GAAAW,KAAAT,IAEAE,EAAAM,OAAAR,EAEAG,SAAAO,KAAAC,OAAAT,MAIAP,SAAAiB,UAAAC,CAAAA,IACA,MAAAC,EAAAX,SAAAC,cAAA,QACAU,EAAAC,aAAA,MAAA,cACAD,EAAAC,aAAA,OAAA,YACAD,EAAAC,aAAA,OAAAF,GACAV,SAAAO,KAAAC,OAAAG,KAGAnB,SAAAqB,KAAA,KAAAC,KACA,IAAAD,EAAA,GACA,KAAAC,EAAAV,QACAU,EAAA,GACAD,MAAAA,GAAA,MAAAA,EAAAA,EAAAT,OAAA,GAAA,IAAA,KAAAU,EAAAX,UADAW,EAAAX,QAGA,OAAAU,IAEArB,SAAAuB,SAAAC,CAAAA,GAAAxB,SAAAqB,KAAArB,SAAAC,QAAAuB,IAEAxB,SAAAyB,SAAA,MACA,MAAAC,EAAA,CAAA,oBACA1B,SAAA2B,WACA3B,SAAA4B,IAAAC,MAAAC,QAAA,EACAJ,EAAAK,KAAA,qBAEAL,EAAAK,KAAA/B,SAAAuB,SAAA,YACAvB,SAAAE,WAAAwB,KAGA1B,SAAAiB,UAAAjB,SAAAuB,SAAA,cAEA,IACA,MAAAS,OAAAA,EAAAC,YAAAC,GAAAC,QAAA,YACAnC,SAAA2B,SAAA,CACAK,OAAAA,EACAE,IAAAA,EACAE,YAAAJ,EAAAG,QAAA,aACApC,OAAAiC,EAAAK,mBACAC,OAAAN,EAAAM,QAEA,MAAAC,ICzDAvC,SAAAwC,KAAA,IAAAC,KAAA,4BAEAzC,SAAAwC,KAAAE,iBAAA,EAAAC,EAAAC,EAAA,EAAAC,IAAA,IAAAzC,QAAA,CAAAC,EAAAyC,KACA9C,SAAAwC,KAAAO,SAAAJ,EAAAC,EAAA,CAAAI,EAAAC,KACAA,EACAH,EAAAG,GAEA5C,EAAA2C,IAEAH,MAGA7C,SAAAwC,KAAAU,mBAAA,EAAAP,EAAAE,IAAA,IAAAzC,QAAA,CAAAC,EAAAyC,KACA9C,SAAAwC,KAAAW,WAAAR,EAAA,CAAAK,EAAAC,KACAA,EACAH,EAAAG,GAEA5C,EAAA2C,IAEAH,MAGA7C,SAAAoD,KAAAC,uBACArD,SAAAwC,KAAAE,iBAAA1C,SAAAsD,SAAA,IAEAtD,SAAAuD,KAAAF,uBACArD,SAAAwC,KAAAU,mBAAA,SCtBAlD,SAAA4B,IAAA,IAAA4B,IAAA,CACAC,GAAA,WACAd,KAAA,CACAe,aAAA,KACAC,QAAA,GACA7B,QAAA,KAMA9B,SAAA4D,aAAA,EAAAC,EAAAC,KACA,MAAAC,EAAA/D,SAAA4B,IAAAC,MACAmC,EAAA,CACAC,GAAAF,EAAAJ,QAAA/C,OACAiD,KAAAA,EACAC,UAAAA,GAEA,IAAAC,EAAAJ,QAAA/C,SAAAmD,EAAAL,aAAAM,GACAD,EAAAJ,QAAA5B,KAAAiC,KAGAhE,SAAA4D,aAAA,MAAA,CACAM,SAAA,2HAIAC,UAEAnE,SAAAyB","file":"filament.js","sourcesContent":["if(!window.Filament){ window.Filament={\n\tgameDir: \"./game/\"\n};}\n\nFilament.loadScript=sources=>{\n\treturn new Promise(resolve=>{\n\t\tif( !(sources instanceof Array) ){ sources = [sources]; }\n\t\tconst script = document.createElement(\"script\");\n\t\tscript.src = sources.shift();\n\t\tif( sources.length ) {\n\t\t\tscript.onload =()=>Filament.loadScript(sources).then(resolve);\n\t\t}else{\n\t\t\tscript.onload = resolve;\n\t\t}\n\t\tdocument.head.append(script);\n\t});\n};\n\nFilament.loadStyle=source=>{\n\tconst stylesheet = document.createElement(\"link\");\n\tstylesheet.setAttribute('rel','stylesheet');\n\tstylesheet.setAttribute('type','text/css');\n\tstylesheet.setAttribute('href',source);\n\tdocument.head.append(stylesheet);\n}\n\nFilament.path=(...parts)=>{\n\tlet path='';\n\twhile(parts.length){\n\t\tif(!parts[0]){ parts.shift();continue; }\n\t\tpath+=`${!path||path[path.length-1]==='/'?'':'/'}${parts.shift()}`;\n\t}\n\treturn path;\n};\nFilament.gameFile=filename=>Filament.path(Filament.gameDir,filename);\n\nFilament.loadGame=()=>{\n\tconst scripts = [\"engine/engine.js\"];\n\tif(Filament.electron){\n\t\tFilament.vue.$data.editor=true;\n\t\tscripts.push(\"engine/editor.js\");\n\t}\n\tscripts.push(Filament.gameFile(\"game.js\"));\n\tFilament.loadScript(scripts);\n};\n\nFilament.loadStyle(Filament.gameFile('style.css'));\n\ntry{\n\tconst { remote, ipcRenderer:ipc } = require('electron');\n\tFilament.electron={\n\t\tremote:remote,\n\t\tipc:ipc,\n\t\tmainProcess:remote.require('./main.js'),\n\t\twindow:remote.getCurrentWindow(),\n\t\tdialog:remote.dialog\n\t}\n}catch(err){}\n","Filament.lzma = new LZMA(\"./lib/lzma_worker-min.js\");\n\nFilament.lzma.compress_promise=(data,mode=1,progress=undefined)=>new Promise((resolve,reject)=>{\n\tFilament.lzma.compress(data,mode,(result,error)=>{\n\t\tif(error){\n\t\t\treject(error);\n\t\t}else{\n\t\t\tresolve(result);\n\t\t}\n\t},progress);\n});\n\nFilament.lzma.decompress_promise=(data,progress)=>new Promise((resolve,reject)=>{\n\tFilament.lzma.decompress(data,(result,error)=>{\n\t\tif(error){\n\t\t\treject(error);\n\t\t}else{\n\t\t\tresolve(result);\n\t\t}\n\t},progress);\n});\n\nFilament.save = async function(){\n\tawait Filament.lzma.compress_promise(Filament.savedata,1);\n}\nFilament.load = async function(){\n\tawait Filament.lzma.decompress_promise(\"TODO\");\n}","// register components\n\n// setup vue\n\nFilament.vue = new Vue({ \n\tel:'#wrapper',\n\tdata:{\n\t\tactiveScreen:null,\n\t\tscreens:[],\n\t\teditor:false,\n\t}\n});\n\n// add screens\n\nFilament.editorScreen=(name,component)=>{\n\tconst v = Filament.vue.$data;\n\tconst screen = {\n\t\tid: v.screens.length,\n\t\tname: name,\n\t\tcomponent: component,\n\t};\n\tif(v.screens.length===0){ v.activeScreen = screen; }\n\tv.screens.push(screen);\n};\n\nFilament.editorScreen(\"Map\",{\n\ttemplate:`<div id=\"screen-game\" tabindex=\"0\">\n\t\t<canvas id=\"pixi-canvas\"></canvas>\n\t\t<div id=\"ui-container\"></div>\n\t</div>`,\n\tmounted(){\n\t\t// run game script\n\t\tFilament.loadGame();\n\t},\n});"]}