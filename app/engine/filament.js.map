{"version":3,"sources":["0_filament.js","lzma.js","vue.js"],"names":["window","Filament","gameDir","loadScript","sources","Promise","resolve","Array","script","document","createElement","src","shift","length","onload","then","head","append","loadStyle","source","stylesheet","setAttribute","path","parts","gameFile","filename","loadGame","scripts","electron","push","remote","ipcRenderer","ipc","require","mainProcess","getCurrentWindow","dialog","err","lzma","LZMA","compress_promise","data","mode","progress","reject","compress","result","error","decompress_promise","decompress","save","async","savedata","load","vue","Vue","el","activeScreen","screens","editorScreen","name","component","v","$data","screen","id","template","[object Object]"],"mappings":"AAAAA,OAAAC,WAAAD,OAAAC,SAAA,CACAC,QAAA,YAGAD,SAAAE,WAAAC,CAAAA,GACA,IAAAC,QAAAC,IACAF,aAAAG,QAAAH,EAAA,CAAAA,IACA,MAAAI,EAAAC,SAAAC,cAAA,UACAF,EAAAG,IAAAP,EAAAQ,QACAR,EAAAS,OACAL,EAAAM,OAAA,KAAAb,SAAAE,WAAAC,GAAAW,KAAAT,IAEAE,EAAAM,OAAAR,EAEAG,SAAAO,KAAAC,OAAAT,MAIAP,SAAAiB,UAAAC,CAAAA,IACA,MAAAC,EAAAX,SAAAC,cAAA,QACAU,EAAAC,aAAA,MAAA,cACAD,EAAAC,aAAA,OAAA,YACAD,EAAAC,aAAA,OAAAF,GACAV,SAAAO,KAAAC,OAAAG,KAGAnB,SAAAqB,KAAA,KAAAC,KACA,IAAAD,EAAA,GACA,KAAAC,EAAAV,QACAU,EAAA,GACAD,MAAAA,GAAA,MAAAA,EAAAA,EAAAT,OAAA,GAAA,IAAA,KAAAU,EAAAX,UADAW,EAAAX,QAGA,OAAAU,IAEArB,SAAAuB,SAAAC,CAAAA,GAAAxB,SAAAqB,KAAArB,SAAAC,QAAAuB,IAEAxB,SAAAyB,SAAA,MACA,MAAAC,EAAA,CAAA,oBACA1B,SAAA2B,UACAD,EAAAE,KAAA,oBAEAF,EAAAE,KAAA5B,SAAAuB,SAAA,YACAvB,SAAAE,WAAAwB,KAGA1B,SAAAiB,UAAAjB,SAAAuB,SAAA,cAEA,IACA,MAAAM,OAAAA,EAAAC,YAAAC,GAAAC,QAAA,YACAhC,SAAA2B,SAAA,CACAE,OAAAA,EACAE,IAAAA,EACAE,YAAAJ,EAAAG,QAAA,aACAjC,OAAA8B,EAAAK,mBACAC,OAAAN,EAAAM,QAEA,MAAAC,ICxDApC,SAAAqC,KAAA,IAAAC,KAAA,4BAEAtC,SAAAqC,KAAAE,iBAAA,EAAAC,EAAAC,EAAA,EAAAC,IAAA,IAAAtC,QAAA,CAAAC,EAAAsC,KACA3C,SAAAqC,KAAAO,SAAAJ,EAAAC,EAAA,CAAAI,EAAAC,KACAA,EACAH,EAAAG,GAEAzC,EAAAwC,IAEAH,MAGA1C,SAAAqC,KAAAU,mBAAA,EAAAP,EAAAE,IAAA,IAAAtC,QAAA,CAAAC,EAAAsC,KACA3C,SAAAqC,KAAAW,WAAAR,EAAA,CAAAK,EAAAC,KACAA,EACAH,EAAAG,GAEAzC,EAAAwC,IAEAH,MAGA1C,SAAAiD,KAAAC,uBACAlD,SAAAqC,KAAAE,iBAAAvC,SAAAmD,SAAA,IAEAnD,SAAAoD,KAAAF,uBACAlD,SAAAqC,KAAAU,mBAAA,SCtBA/C,SAAAqD,IAAA,IAAAC,IAAA,CACAC,GAAA,WACAf,KAAA,CACAgB,aAAA,KACAC,QAAA,MAMAzD,SAAA0D,aAAA,EAAAC,EAAAC,KACA,MAAAC,EAAA7D,SAAAqD,IAAAS,MACAC,EAAA,CACAC,GAAAH,EAAAJ,QAAA7C,OACA+C,KAAAA,EACAC,UAAAA,GAEA,IAAAC,EAAAJ,QAAA7C,SAAAiD,EAAAL,aAAAO,GACAF,EAAAJ,QAAA7B,KAAAmC,KAGA/D,SAAA0D,aAAA,MAAA,CACAO,SAAA,8GAIAC,UAEAlE,SAAAyB","file":"filament.js","sourcesContent":["if(!window.Filament){ window.Filament={\r\n\tgameDir: \"./game/\"\r\n};}\r\n\r\nFilament.loadScript=sources=>{\r\n\treturn new Promise(resolve=>{\r\n\t\tif( !(sources instanceof Array) ){ sources = [sources]; }\r\n\t\tconst script = document.createElement(\"script\");\r\n\t\tscript.src = sources.shift();\r\n\t\tif( sources.length ) {\r\n\t\t\tscript.onload =()=>Filament.loadScript(sources).then(resolve);\r\n\t\t}else{\r\n\t\t\tscript.onload = resolve;\r\n\t\t}\r\n\t\tdocument.head.append(script);\r\n\t});\r\n};\r\n\r\nFilament.loadStyle=source=>{\r\n\tconst stylesheet = document.createElement(\"link\");\r\n\tstylesheet.setAttribute('rel','stylesheet');\r\n\tstylesheet.setAttribute('type','text/css');\r\n\tstylesheet.setAttribute('href',source);\r\n\tdocument.head.append(stylesheet);\r\n}\r\n\r\nFilament.path=(...parts)=>{\r\n\tlet path='';\r\n\twhile(parts.length){\r\n\t\tif(!parts[0]){ parts.shift();continue; }\r\n\t\tpath+=`${!path||path[path.length-1]==='/'?'':'/'}${parts.shift()}`;\r\n\t}\r\n\treturn path;\r\n};\r\nFilament.gameFile=filename=>Filament.path(Filament.gameDir,filename);\r\n\r\nFilament.loadGame=()=>{\r\n\tconst scripts = [\"engine/engine.js\"];\r\n\tif(Filament.electron){\r\n\t\tscripts.push(\"engine/editor.js\");\r\n\t}\r\n\tscripts.push(Filament.gameFile(\"game.js\"));\r\n\tFilament.loadScript(scripts);\r\n};\r\n\r\nFilament.loadStyle(Filament.gameFile('style.css'));\r\n\r\ntry{\r\n\tconst { remote, ipcRenderer:ipc } = require('electron');\r\n\tFilament.electron={\r\n\t\tremote:remote,\r\n\t\tipc:ipc,\r\n\t\tmainProcess:remote.require('./main.js'),\r\n\t\twindow:remote.getCurrentWindow(),\r\n\t\tdialog:remote.dialog\r\n\t}\r\n}catch(err){}\r\n","Filament.lzma = new LZMA(\"./lib/lzma_worker-min.js\");\r\n\r\nFilament.lzma.compress_promise=(data,mode=1,progress=undefined)=>new Promise((resolve,reject)=>{\r\n\tFilament.lzma.compress(data,mode,(result,error)=>{\r\n\t\tif(error){\r\n\t\t\treject(error);\r\n\t\t}else{\r\n\t\t\tresolve(result);\r\n\t\t}\r\n\t},progress);\r\n});\r\n\r\nFilament.lzma.decompress_promise=(data,progress)=>new Promise((resolve,reject)=>{\r\n\tFilament.lzma.decompress(data,(result,error)=>{\r\n\t\tif(error){\r\n\t\t\treject(error);\r\n\t\t}else{\r\n\t\t\tresolve(result);\r\n\t\t}\r\n\t},progress);\r\n});\r\n\r\nFilament.save = async function(){\r\n\tawait Filament.lzma.compress_promise(Filament.savedata,1);\r\n}\r\nFilament.load = async function(){\r\n\tawait Filament.lzma.decompress_promise(\"TODO\");\r\n}","// register components\r\n\r\n// setup vue\r\n\r\nFilament.vue = new Vue({ \r\n\tel:'#wrapper',\r\n\tdata:{\r\n\t\tactiveScreen:null,\r\n\t\tscreens:[],\r\n\t}\r\n});\r\n\r\n// add screens\r\n\r\nFilament.editorScreen=(name,component)=>{\r\n\tconst v = Filament.vue.$data;\r\n\tconst screen = {\r\n\t\tid: v.screens.length,\r\n\t\tname: name,\r\n\t\tcomponent: component,\r\n\t};\r\n\tif(v.screens.length===0){ v.activeScreen = screen; }\r\n\tv.screens.push(screen);\r\n};\r\n\r\nFilament.editorScreen(\"Map\",{\r\n\ttemplate:`<div id=\"screen-game\">\r\n\t\t<canvas id=\"pixi-canvas\"></canvas>\r\n\t\t<div id=\"ui-container\"></div>\r\n\t</div>`,\r\n\tmounted(){\r\n\t\t// run game script\r\n\t\tFilament.loadGame();\r\n\t},\r\n});"]}